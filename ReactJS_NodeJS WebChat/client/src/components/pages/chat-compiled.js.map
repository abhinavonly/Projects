{"version":3,"sources":["chat.js"],"names":[],"mappings":"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","file":"chat-compiled.js","sourcesContent":["/**\n * Created by zh355245849 on 2016/11/26.\n */\n// app-client.js\nimport React, { Component } from 'react'\nimport { render } from 'react-dom'\nimport io from 'socket.io-client'\nimport uuid from 'node-uuid'\nimport S from 'shorti'\nimport _ from 'lodash'\nimport { Input } from 'react-bootstrap'\nvar socket = io.connect();\n\nclass chat extends Component {\n\n    constructor() {\n        super()\n        this.state = {\n            data: {\n                messages: []\n            }\n        }\n    }\n\n    componentDidMount() {\n        const data = this.state.data\n        const messages = data.messages\n\n        socket.on('updatechat', (data) => {\n            console.log(data);\n            const message_browser = {\n                _id: uuid.v1(),\n                metafield: {\n                    message: {\n                        value: data\n                    }\n                }\n            }\n\n            messages.push(message_browser)\n            this.setState({\n                data: {\n                    messages\n                }\n            })\n            this.refs.message.refs.input.value = ''\n        });\n    }\n\n    createMessage() {\n        const data = this.state.data\n        const messages = data.messages\n        const message_text = this.refs.message.refs.input.value.trim()\n        if (!message_text)\n            return\n\n        socket.emit(\"sendchat\", {room:\"room1\", message:message_text})\n\n        // Render to browser\n        const message_browser = {\n            _id: uuid.v1(),\n            metafield: {\n                message: {\n                    value: message_text\n                }\n            }\n        }\n\n        messages.push(message_browser)\n        this.setState({\n            data: {\n                messages\n            }\n        })\n        this.refs.message.refs.input.value = ''\n    }\n\n    handleSubmit(e) {\n        e.preventDefault()\n        this.createMessage()\n    }\n\n    render() {\n        const data = this.state.data\n        let form_input\n\n        form_input = (\n            <div>\n                Hello { data.author }, type a message:<br />\n                <Input type=\"text\" ref=\"message\" />\n            </div>\n        )\n        const messages = data.messages\n        let messages_list\n        if (messages) {\n            // order by created\n            const sorted_messages = _.sortBy(messages, message => {\n                return message.created\n            })\n            messages_list = sorted_messages.map(message_object => {\n                if (message_object) {\n                    return (\n                        <li style={ { listStyle: 'none', ...S('mb-5') } } key={ message_object._id }>\n                            <b>Nickname</b><br/>\n                            { message_object.metafield.message.value }\n                        </li>\n                    )\n                }\n            })\n        }\n        const scroll_area_style = {\n            ...S('h-' + (window.innerHeight - 140)),\n            overflowY: 'scroll'\n        }\n        return (\n            <div>\n                <div style={ S('pl-15') }>\n                    <h2>React Chat Channel</h2>\n                    <div id=\"text\" ref=\"messages_scroll_area\" style={ scroll_area_style }>\n                        <ul style={ S('p-0') }>{ messages_list }</ul>\n                    </div>\n                </div>\n                <div style={ S('absolute b-0 w-100p pl-15 pr-15') }>\n                    <form onSubmit={ this.handleSubmit.bind(this) }>\n                        { form_input }\n                    </form>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default chat\n"]}