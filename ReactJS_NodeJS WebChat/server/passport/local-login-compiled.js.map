{"version":3,"sources":["local-login.js"],"names":[],"mappings":";;AAAA,IAAM,gBAAgB,QAAQ,gBAAR,EAA0B,QAAhD;AACA,IAAM,OAAO,QAAQ,UAAR,EAAoB,KAApB,CAA0B,MAA1B,CAAb;AACA,IAAM,MAAM,QAAQ,cAAR,CAAZ;AACA,IAAM,SAAS,QAAQ,cAAR,CAAf;AACA,OAAO,OAAP,GAAiB,UAAS,MAAT,EAAiB;AAC9B,WAAQ,IAAI,aAAJ,CACJ;AACI,uBAAe,WADnB;AAEI,uBAAe,UAFnB;AAGI,iBAAS,KAHb;AAII,2BAAmB;AAJvB,KADI,EAOJ,UAAC,GAAD,EAAK,SAAL,EAAe,QAAf,EAAyB,IAAzB,EAAkC;AAC1B,aAAK,OAAL,CAAa,EAAE,kBAAkB,SAApB,EAAb,EAA6C,UAAC,GAAD,EAAM,IAAN,EAAe;AACxD,gBAAI,GAAJ,EACI,OAAO,KAAK,GAAL,CAAP;AACJ,gBAAI,CAAC,IAAD,IAAS,CAAC,KAAK,aAAL,CAAmB,QAAnB,CAAd,EAA4C;AACxC,uBAAO,KAAK,IAAL,EAAU,IAAV,EAAe,KAAf,CAAP;AACH,aAFD,MAIA;AACI,oBAAI,QAAQ,IAAI,IAAJ,CAAS,EAAE,MAAM,KAAK,QAAb,EAAT,EAAkC,OAAO,SAAzC,CAAZ;AACA,uBAAO,KAAK,IAAL,EAAU,KAAV,EAAgB,KAAK,QAArB,CAAP;AACH;AACJ,SAXD;AAYP,KApBG,CAAR;AAqBH,CAtBD;;;;;;;;kCAJM,a;;kCACA,I","file":"local-login-compiled.js","sourcesContent":["const LocalStrategy = require('passport-local').Strategy;\nconst User = require('mongoose').model('User');     \nconst jwt = require('jsonwebtoken');\nconst secret = require('../../config');\nmodule.exports = function(config) {\n    return  new LocalStrategy(\n        {\n            usernameField: 'useremail',\n            passwordField: 'password',\n            session :false,\n            passReqToCallback: true\n        },\n        (req,useremail,password, done) => {\n                User.findOne({ 'user.useremail': useremail}, (err, user) => {\n                    if (err)\n                        return done(err);\n                    if (!user || !user.validPassword(password)) {\n                        return done(null,null,false);\n                    }\n                    else \n                    {\n                        var token = jwt.sign({ user: user.nickname }, secret.jwtSecret);\n                        return done(null,token,user.nickname);\n                    }\n                });\n        });\n}"]}